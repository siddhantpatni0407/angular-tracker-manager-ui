<div class="container mt-4">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <button class="btn btn-outline-primary" (click)="goBack()">
      â¬… Back to Credential Tracker
    </button>
    <h2 class="text-primary fw-bold">
      <i class="bi bi-shield-lock"></i> Credentials
    </h2>
    <div></div>
  </div>

  <!-- Search Input -->
  <div class="row g-3 align-items-center mb-4">
    <div class="col-md-8">
      <label class="form-label fw-bold">ğŸ” Search Credentials</label>
      <input
        type="text"
        class="form-control shadow-sm"
        placeholder="Filter by account name, type, or username..."
        [(ngModel)]="searchText"
        (input)="filterCredentials()"
      />
    </div>

    <!-- Export Dropdown -->
    <div class="col-md-4 text-end" style="position: relative; z-index: 1050">
      <label class="form-label fw-bold d-block">ğŸ“¤ Export</label>
      <div class="btn-group">
        <button
          class="btn btn-primary dropdown-toggle shadow-sm"
          type="button"
          id="exportDropdown"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          Export Data
        </button>
        <ul class="dropdown-menu dropdown-menu-end" style="z-index: 1051">
          <li>
            <a class="dropdown-item" (click)="exportToExcel()">
              <i class="bi bi-file-earmark-spreadsheet"></i> Export to Excel
            </a>
          </li>
          <li>
            <a class="dropdown-item" (click)="exportToPDF()">
              <i class="bi bi-file-earmark-pdf"></i> Export to PDF
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Credentials Table with Scroll -->
  <div class="table-responsive" style="max-height: 400px; overflow-y: auto">
    <table class="table table-hover table-bordered text-center shadow-sm">
      <thead class="table-dark sticky-top">
        <tr>
          <th>#</th>
          <th (click)="sortCredentials('accountName')" class="sortable">
            ğŸ” Account Name â¬
          </th>
          <th (click)="sortCredentials('accountType')" class="sortable">
            ğŸ“ Account Type â¬
          </th>
          <th (click)="sortCredentials('website')" class="sortable">
            ğŸŒ Website â¬
          </th>
          <th (click)="sortCredentials('url')" class="sortable">ğŸ”— URL â¬</th>
          <th (click)="sortCredentials('username')" class="sortable">
            ğŸ‘¤ Username â¬
          </th>
          <th (click)="sortCredentials('email')" class="sortable">
            ğŸ“§ Email â¬
          </th>
          <th (click)="sortCredentials('mobileNumber')" class="sortable">
            ğŸ“± Mobile Number â¬
          </th>
          <th (click)="sortCredentials('status')" class="sortable">
            ğŸ“Š Status â¬
          </th>
          <th (click)="sortCredentials('remarks')" class="sortable">
            ğŸ“ Remarks â¬
          </th>
          <th>ğŸ”‘ Password</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let credential of filteredCredentials; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ credential.accountName }}</td>
          <td>{{ credential.accountType }}</td>
          <td>{{ credential.website }}</td>
          <td>{{ credential.url }}</td>
          <td>{{ credential.username }}</td>
          <td>{{ credential.email }}</td>
          <td>{{ credential.mobileNumber }}</td>
          <td>{{ credential.status }}</td>
          <td>{{ credential.remarks }}</td>
          <td>
            <div class="d-flex align-items-center justify-content-center">
              <!-- Password Field -->
              <span *ngIf="!credential.showPassword">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</span>
              <span *ngIf="credential.showPassword">{{
                credential.password
              }}</span>

              <!-- View Icon -->
              <button
                class="btn btn-link p-0 ms-2"
                (click)="togglePasswordVisibility(credential)"
              >
                <i
                  class="bi"
                  [ngClass]="{
                    'bi-eye': !credential.showPassword,
                    'bi-eye-slash': credential.showPassword
                  }"
                ></i>
              </button>
            </div>
          </td>
        </tr>

        <!-- No Data Found Row -->
        <tr *ngIf="filteredCredentials.length === 0">
          <td colspan="11" class="text-center text-muted">
            âš ï¸ No credentials found.
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

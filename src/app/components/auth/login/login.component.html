<div class="container mt-5 fade-in">
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      <div class="card shadow-lg rounded-lg custom-card">
        <div class="card-header bg-gradient bg-primary text-white text-center py-4">
          <h5 class="mb-0">üîê {{ isForgotPassword ? 'Forgot Password' : 'Login' }}</h5>
        </div>
        <div class="card-body">
          
          <!-- ‚úÖ Success Message -->
          <div *ngIf="successMessage" class="alert alert-success text-center fade-in">
            ‚úÖ {{ successMessage }}
          </div>

          <!-- ‚ùå Error Message -->
          <div *ngIf="errorMessage" class="alert alert-danger text-center fade-in">
            ‚ùå {{ errorMessage }}
          </div>

          <!-- üöÄ Login Form -->
          <form *ngIf="!isForgotPassword" #loginForm="ngForm" (ngSubmit)="login()">
            
            <!-- Email Field -->
            <div class="mb-3">
              <label class="form-label fw-bold">Email</label>
              <input type="email" [(ngModel)]="email" class="form-control custom-input" name="email" required />
            </div>

            <!-- Password Field -->
            <div class="mb-3">
              <label class="form-label fw-bold">Password</label>
              <div class="input-group">
                <input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="password" class="form-control custom-input" name="password" required />
                <button type="button" class="btn btn-outline-secondary" (click)="togglePassword()">
                  <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
                </button>
              </div>
            </div>

            <!-- Role Selection Dropdown -->
            <div class="mb-3">
              <label class="form-label fw-bold">Select Role</label>
              <select [(ngModel)]="selectedRole" name="role" class="form-control custom-input" required>
                <option value="" disabled selected>-- Select Role --</option>
                <option value="USER">User</option>
                <option value="ADMIN">Admin</option>
              </select>
            </div>

            <!-- Login Button -->
            <button class="btn btn-primary w-100 rounded-pill py-2 animated-btn" [disabled]="loginForm.invalid">
              <i class="bi bi-box-arrow-in-right"></i> Login
            </button>

            <!-- Forgot Password Link -->
            <div class="text-center mt-3">
              <a href="javascript:void(0)" class="text-primary fw-bold" (click)="toggleForgotPassword()">Forgot Password?</a>
            </div>
          </form>

          <!-- üîë Forgot Password Form -->
          <form *ngIf="isForgotPassword" #forgotPasswordForm="ngForm" (ngSubmit)="requestOtpOrResetPassword()">
            
            <!-- Email Field for OTP Request -->
            <div class="mb-3" *ngIf="!otpRequested">
              <label class="form-label fw-bold">Enter Your Email</label>
              <input type="email" [(ngModel)]="forgotEmail" class="form-control custom-input" name="forgotEmail" required />
            </div>

            <!-- OTP & New Password Fields -->
            <div *ngIf="otpRequested">
              <div class="mb-3">
                <label class="form-label fw-bold">Enter OTP</label>
                <input type="text" [(ngModel)]="otp" class="form-control custom-input" name="otp" required />
              </div>

              <div class="mb-3">
                <label class="form-label fw-bold">New Password</label>
                <input type="password" [(ngModel)]="newPassword" class="form-control custom-input" name="newPassword" required minlength="6" />
              </div>
            </div>

            <!-- Submit Button -->
            <button class="btn btn-primary w-100 rounded-pill py-2 animated-btn">
              {{ otpRequested ? 'Reset Password' : 'Request OTP' }}
            </button>

            <!-- Back to Login -->
            <div class="text-center mt-3">
              <a href="javascript:void(0)" class="text-secondary fw-bold" (click)="toggleForgotPassword()">Back to Login</a>
            </div>
          </form>

        </div>
      </div>
    </div>
  </div>
</div>
